<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reporte de Pruebas</title>
  <style>/*{{STYLES}}*/</style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="header">
    <h1>Reporte de Playwright</h1>
  </header>
  <main class="container">
    <section class="summary">
      <div id="summary"></div>
      <canvas id="chart"></canvas>
    </section>
    <section id="tests" class="tests"></section>
  </main>
  <!--{{DATA}}-->
  <script>
    const dataEl = document.getElementById('data');
    const payload = JSON.parse(dataEl.textContent);
    const sEl = document.getElementById('summary');
    const stats = payload.stats;
    sEl.innerHTML = `<div class="cards"><div class="card"><h3>Total</h3><p>${stats.total}</p></div><div class="card passed"><h3>Passed</h3><p>${stats.passed}</p></div><div class="card failed"><h3>Failed</h3><p>${stats.failed}</p></div><div class="card skipped"><h3>Skipped</h3><p>${stats.skipped}</p></div><div class="card"><h3>Duración(ms)</h3><p>${stats.durationMs}</p></div></div>`;
    const ctx = document.getElementById('chart');
    new Chart(ctx, { type: 'doughnut', data: { labels: ['Passed','Failed','Skipped'], datasets: [{ data: [stats.passed, stats.failed, stats.skipped], backgroundColor: ['#22c55e','#ef4444','#f59e0b'] }] } });
    const testsEl = document.getElementById('tests');
    payload.tests.forEach(t => {
      const div = document.createElement('div');
      div.className = `test ${t.status}`;
      const stepsHtml = t.steps.map(s => `<li><span>${s.title}</span><span>${(s.duration||0)}ms</span></li>`).join('');
      const attsHtml = t.attachments.filter(a=>a.path).map(a => `<img src="${a.path}" alt="${a.name}"/>`).join('');
      div.innerHTML = `<h2>${t.title}</h2><p>Estado: ${t.status} | Duración: ${t.duration}ms</p><h3>Pasos</h3><ul class="steps">${stepsHtml}</ul><h3>Evidencias</h3><div class="attachments">${attsHtml}</div>`;
      testsEl.appendChild(div);
    });
  </script>
</body>
</html>